{% extends "base_template.html" %}

{% block content %}
  <h1>Order Slip</h1>
  <p>Welcome to Blizzard Blast!, an internal database system developed by <em>Franco <3</em>!</p>
  <h2>Dynamic content</h2>

  <h3>Order Slips</h3>

    <!-- Order Slip Select Box -->
    <select id="orderSearch" onchange="location.href=document.getElementById('orderSearch').value">
        <option value="">---</option>
        {% for os in OrderSlip %}
            {% if os == LastOrderSlip %}
            <option value="{{os.order_id}}" selected>{{os}}</option>
            {% else %}
            <option value="{{os.order_id}}">{{os}}</option>
            {% endif %}
        {% endfor %}
    </select>

    <button type="button" onclick="location.href=document.getElementById('orderSearch').value">Search Order</button>
    <button type="button" onclick="location.href='new/'">New Order Slip</button>

    <br><br>

    <!-- Order Slip Details -->
    <b>{{LastOrderSlip.customer_name}} ({{LastOrderSlip.date_ordered}})</b> | ₱ {{LastOrderSlip.order_price}}<br>
        Order ID: {{LastOrderSlip.order_id}}
        <button type="button" onclick="location.href='../slip/delete/{{LastOrderSlip.order_id}}'">Delete Order Slip</button>
        
        <ol>
            <!-- Each Order Item in the Order Slip-->
            {% for oi in OrderItem %}
            {% if oi.order == LastOrderSlip %}
            <li><b>{{oi.recipe.recipe_name}} ({{oi.recipe.serving_size}}oz)</b> | ₱{{oi.item_price}}
            <button type="button" onclick="location.href='../item/delete/{{oi.order_item_id}}'">Delete Item</button>
                
                <!-- Each Item Add-On in the Order Item-->
                {% for ia in ItemAddOn %}
                {% if ia.order_item == oi %}
                <br><i>{{ia.ingredient.ingredient_name}}: ₱{{ia.ingredient.price_serving}} x {{ia.add_on_quantity}} = ₱{% widthratio ia.ingredient.price_serving 1 ia.add_on_quantity %}</i>
                <button type="button" onclick="location.href='../item/addon/delete/{{ia.item_addon_id}}'">Delete Add-On</button>
                {% endif %}
                {% endfor %}

            <br>
            <button type="button" onclick="location.href='../item/addon/new/{{oi.order_item_id}}'"> Add Add-On</button>
            </li>
            {% endif %}
            {% endfor %}
        </ol>
        
    <button type="button" onclick="location.href='../item/new/{{LastOrderSlip.order_id}}'"> Add Item</button>
{% endblock %}